### 架构的本质

通过合理的内部编排，保证系统的高度有序，能够不断扩展，满足技术和业务的变化

首先，架构的出发点是业务和技术在不断复杂化，引起系统混乱，需要通过架构来保证有序

其次，架构实现从无序到有序，是通过合理的内部编排实现的，基本的手段，就是“分”与“合”，先把系统打散，然后将它们重新组合，形成更合理的关系(分->合理定位, 合->有机整体)

“分”就是把系统拆分为各个子系统、模块、组件

“合”就是基于业务流程和技术手段，把各个组件有机整合在一起

这个分与合的过程将系统的复杂性分解为两个层次：

首先，各个子系统承担独立的职责，内部包含了自身的复杂性。子系统的复杂性对外部是透明的，外部不用关心。

其次，子系统通过封装后，简化为职责明确的一个点，因此，我们只需要在合的过程中，解决各个点之间的依赖关系，这样就可以定义出系统整体。

通过合理的“分”与“合”，系统不是回到了原点，而是把原先铁板一块的系统变成一个富有弹性的结构化系统。这样，系统的复杂性有效地分解了，系统的有序度大幅度地提升了。

#### 架构分类

业务架构就是讲清楚核心业务的处理过程，定义各个业务模块的相互关系，它从概念层面帮助我们理解系统面临哪些问题以及如何处理；

应用架构就是讲清楚系统内部是怎么组织的，有哪些应用，相互间是怎么调用的，它从逻辑层面帮助我们理解系统内部是如何分工与协作的。

技术架构就是讲清楚系统由哪些硬件、操作系统和中间件组成，它们是如何和我们开发的应用一起配合，应对各种异常情况，保持系统的稳定可用。所以，技术架构从物理层面帮助我们理解系统是如何构造的，以及如何解决稳定性的问题。

业务架构、应用架构和技术架构，分别从概念、逻辑和物理层面定义一个系统

技术架构通过保障应用的稳定运行，最终保证业务不出问题

#### 好的架构

一个好的架构设计既要满足业务的可扩展、可复用；也要满足系统的高可用、高性能和可伸缩，并尽量采用低成本的方式落地。所以，对架构设计来说，技术和业务两手都要抓，两手都要硬。

### 方法论

本质论: 透过现象看本质, 抓住事务的本质

矛盾论：主要矛盾是解决问题的核心

系统论：站在矛盾的各方面去分析，体系化思考解决方案,由点到线再到面，站在不同的维度思考应该要怎么去做?

演进论: 有目标， 有计划， 分阶段解决问题

### 业务架构

业务架构师来说就是把业务流程和节点打散，按照业务域的维度来划分系统模块，并定义这些模块之间的关系，最终形成一个高度结构化的模块体系

#### 架构目标

**业务的可扩展**

业务架构设计要能支持打造一个柔性系统，通过提供良好的业务扩展性，允许业务不断调整和快速生长。

业务的主题是变化和创新，系统的主题是稳定和可靠。

可扩展本质是占位符思想， 分隔变与不变

业务模块布局，合理的层次划分，弹性结构，为新增业务留出扩展空间

**业务的可复用**

首先，模块的职责定位要非常清晰

其次， 模块的数据模型和接口设计要保证通用

最后，实现模块的高复用，还需要做好业务的层次划分

#### 业务模块梳理

场景->流程-> 步骤或节点 -> 节点有输入输出和功能 

按业务域归类节点,  某一类形成一组也许可以作为业务模块

### 可扩展架构

**场景**

如何快速上线新业务不影响老业务？

对某个功能进行修改，如何不影响到系统其它的功能？

#### 系统的组成

**模块**   

泛指子系统，应用，服务或功能模块

从业务的角度，每个模块代表了特定的业务领域

模块内部由数据和业务逻辑组成, 数据是核心，业务逻辑对数据进行加工处理

从扩展性角度:  **定位明确，概念完整**,   **自成体系，粒度适中**(围绕自身内部数据进行处理)

**依赖关系**

定义了模块如何协作，一起完成业务流程，实质体现的是模块的组织结构

简化依赖的方向和依赖的数量,  **单向**,  **将网状结构转化为层次结构**,  **根据模块定位划分为不同的层次**

#### 扩展性本质

通过构建合理的模块体系，有效地控制系统复杂度， 最小化业务变化引起的系统调整

**通过拆分实现模块划分，通过整合，优化模块依赖关系**

#### 拆分

##### **水平拆分**

从上到下把系统分为多层,  按处理先后顺序，将业务拆分为多个步骤

业务变化在特定层调整

##### **垂直拆分**

按照不同的业务线或领域拆分

一般做业务架构时，我们先考虑垂直拆分，从大方向上，把不同业务给区分清楚，然后再针对具体业务，按照业务处理流程进行水平拆分。

#### 整合

##### 通用化

通过模块通用化，模块的数量减少了，模块的定位更清晰，概念更完整，职责更聚焦。在实践中，当不同业务线对某个功能需求比较类似时，我们经常会使用这个手段。

##### 平台化整合

平台化是把定位相同的模块组织在一起，以组团的方式对外提供服务。对于外部系统来说，我们可以把这些模块看成是一个整体，一起对业务场景提供全面的支撑。

业务平台化是模块依赖关系层次化的一个特例，只是它偏向于基础能力，在实践中，当业务线很多，业务规则很复杂时，我们经常把底层业务能力抽取出来，进行平台化处理。

### 中台

中台相当于企业的商业操作系统，能过对后台的包装，为前台提供全方位的支持(前台求快，后台求稳）

中台通过实现基础业务的平台化，实现了企业级业务能力的快速复用

中台是微服务的升级, 松散微服务 -> 共享微服务 -> 中台

![image-20210224073507759](D:\person\knowledge\architecture\middle.png)

### 可复用

![image-20210224074013222](D:\person\knowledge\architecture\reuse.png)

#### 技术复用

代码级复用和组件复用

#### 业务复用

业务实体复用针对细分的业务领域

业务流程的复用针对的是业务场景

最高层次的复用是对整个系统的复用(Saas, Paas)

实现业务组件化和平台化的过程中，首要的问题就是基础服务边界的划分。边界划分决定了服务的粒度和职责，

#### 基础服务边界划分

##### 服务完整性原则

在划分服务边界时，要保证服务数据完整、功能全面，这样才能支撑一个完整的业务领域

##### 服务一致性原则

服务的数据和职责要一致，谁拥有信息，谁就负责提供相应的功能

##### 服务正交原则

基础服务相互之间是正交的。比如说会员服务和商品服务，它们代表不同维度的基础业务域，彼此之间不会有调用关系

### 技术架构

简化系统物理模型

![image-20210224233637304](D:\person\knowledge\architecture\系统物理模型.png)

### 参考

https://www.processon.com/view/link/5e51378ce4b0c037b5f9d1e3#outline

https://mp.weixin.qq.com/s/8Uo4Da2vOmIhMcb-b3vy4g

